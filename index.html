<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0050 即時股價監測</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f7f6;
        }
        .card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            text-align: center;
            min-width: 300px;
        }
        h1 { color: #333; font-size: 1.5rem; margin-bottom: 0.5rem; }
        .ticker { color: #666; font-size: 0.9rem; margin-bottom: 1.5rem; }
        .price {
            font-size: 3.5rem;
            font-weight: bold;
            margin: 10px 0;
            color: #e74c3c; /* 預設紅色 (台股漲) */
        }
        .change {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
        }
        .update-time {
            font-size: 0.8rem;
            color: #999;
        }
        .btn-refresh {
            margin-top: 1rem;
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn-refresh:hover { background-color: #2980b9; }
    </style>
</head>
<body>

<div class="card">
    <h1>元大台灣 50</h1>
    <div class="ticker">0050.TW</div>
    <div id="price" class="price">載入中...</div>
    <div id="change" class="change">--</div>
    <div id="time" class="update-time">最後更新：尚未更新</div>
    <button class="btn-refresh" onclick="fetchPrice()">手動重新整理</button>
</div>

<script>
    async function fetchPrice() {
        const priceEl = document.getElementById('price');
        const changeEl = document.getElementById('change');
        const timeEl = document.getElementById('time');

        try {
            // 使用 Yahoo Finance 的公開 Query API (透過 yfinance 轉發或類似服務)
            // 這裡演示使用一個開源的 Finnhub 或類似模擬，由於台股限制，通常建議從後端抓取
            // 下方以 Yahoo Finance 為例的獲取邏輯
            const response = await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/0050.TW?interval=1m&range=1d`);
            const data = await response.json();
            
            const meta = data.chart.result[0].meta;
            const currentPrice = meta.regularMarketPrice;
            const previousClose = meta.previousClose;
            const diff = (currentPrice - previousClose).toFixed(2);
            const percent = ((diff / previousClose) * 100).toFixed(2);
            
            // 更新 UI
            priceEl.innerText = currentPrice.toFixed(2);
            changeEl.innerText = `${diff > 0 ? '▲' : '▼'} ${Math.abs(diff)} (${percent}%)`;
            
            // 根據漲跌變色 (台股：紅漲綠跌)
            if (diff > 0) {
                priceEl.style.color = '#e74c3c';
                changeEl.style.color = '#e74c3c';
            } else if (diff < 0) {
                priceEl.style.color = '#2ecc71';
                changeEl.style.color = '#2ecc71';
            } else {
                priceEl.style.color = '#333';
                changeEl.style.color = '#333';
            }

            const now = new Date();
            timeEl.innerText = `最後更新：${now.toLocaleTimeString()}`;

        } catch (error) {
            priceEl.innerText = "錯誤";
            console.error("無法獲取股價", error);
        }
    }

    // 初始化與定時更新 (每 60 秒更新一次)
    fetchPrice();
    setInterval(fetchPrice, 60000);
</script>

</body>
</html>
